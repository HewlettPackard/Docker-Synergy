<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HPE Enterprise Containers | Windows Golden Images</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/styles.4458c4ff.css" as="style"><link rel="preload" href="/assets/js/app.4458c4ff.js" as="script"><link rel="preload" href="/assets/js/8.5e9abf7f.js" as="script"><link rel="prefetch" href="/assets/js/1.9435caa1.js"><link rel="prefetch" href="/assets/js/10.56ec9916.js"><link rel="prefetch" href="/assets/js/100.1865d5f9.js"><link rel="prefetch" href="/assets/js/101.09c76994.js"><link rel="prefetch" href="/assets/js/102.1e738fb2.js"><link rel="prefetch" href="/assets/js/103.39341665.js"><link rel="prefetch" href="/assets/js/104.7261cd8b.js"><link rel="prefetch" href="/assets/js/105.4f222b90.js"><link rel="prefetch" href="/assets/js/106.ab348ea0.js"><link rel="prefetch" href="/assets/js/107.05f2d3e9.js"><link rel="prefetch" href="/assets/js/108.625e88c6.js"><link rel="prefetch" href="/assets/js/11.9581c9e6.js"><link rel="prefetch" href="/assets/js/12.729bbadb.js"><link rel="prefetch" href="/assets/js/13.2956f066.js"><link rel="prefetch" href="/assets/js/14.5a144bdc.js"><link rel="prefetch" href="/assets/js/15.6aca671f.js"><link rel="prefetch" href="/assets/js/16.f7c2a41f.js"><link rel="prefetch" href="/assets/js/17.126db08a.js"><link rel="prefetch" href="/assets/js/18.a677b8a9.js"><link rel="prefetch" href="/assets/js/19.f5b102c3.js"><link rel="prefetch" href="/assets/js/2.a8c6b452.js"><link rel="prefetch" href="/assets/js/20.d1c31bb2.js"><link rel="prefetch" href="/assets/js/21.2e9564fe.js"><link rel="prefetch" href="/assets/js/22.ed6a6362.js"><link rel="prefetch" href="/assets/js/23.bae633e4.js"><link rel="prefetch" href="/assets/js/24.f437183d.js"><link rel="prefetch" href="/assets/js/25.47f60376.js"><link rel="prefetch" href="/assets/js/26.e81fa223.js"><link rel="prefetch" href="/assets/js/27.03346382.js"><link rel="prefetch" href="/assets/js/28.63524409.js"><link rel="prefetch" href="/assets/js/29.7e0bd54e.js"><link rel="prefetch" href="/assets/js/3.67c92d52.js"><link rel="prefetch" href="/assets/js/30.48ba5cfc.js"><link rel="prefetch" href="/assets/js/31.463cff78.js"><link rel="prefetch" href="/assets/js/32.ac3b0e33.js"><link rel="prefetch" href="/assets/js/33.2bf82de9.js"><link rel="prefetch" href="/assets/js/34.1d5e46f4.js"><link rel="prefetch" href="/assets/js/35.30905600.js"><link rel="prefetch" href="/assets/js/36.1f2ac89d.js"><link rel="prefetch" href="/assets/js/37.e4c79daf.js"><link rel="prefetch" href="/assets/js/38.8bed7bf9.js"><link rel="prefetch" href="/assets/js/39.98994146.js"><link rel="prefetch" href="/assets/js/4.363b5656.js"><link rel="prefetch" href="/assets/js/40.8eae7677.js"><link rel="prefetch" href="/assets/js/41.3e4168f1.js"><link rel="prefetch" href="/assets/js/42.3ba74ae9.js"><link rel="prefetch" href="/assets/js/43.72599437.js"><link rel="prefetch" href="/assets/js/44.1735c154.js"><link rel="prefetch" href="/assets/js/45.56ae429e.js"><link rel="prefetch" href="/assets/js/46.30933404.js"><link rel="prefetch" href="/assets/js/47.ae580beb.js"><link rel="prefetch" href="/assets/js/48.54830936.js"><link rel="prefetch" href="/assets/js/49.f6e1e1f6.js"><link rel="prefetch" href="/assets/js/5.3420d8f9.js"><link rel="prefetch" href="/assets/js/50.5ba8859a.js"><link rel="prefetch" href="/assets/js/51.8121c744.js"><link rel="prefetch" href="/assets/js/52.c6aed27d.js"><link rel="prefetch" href="/assets/js/53.e21db18d.js"><link rel="prefetch" href="/assets/js/54.138a86f3.js"><link rel="prefetch" href="/assets/js/55.b3aa04b1.js"><link rel="prefetch" href="/assets/js/56.1233748d.js"><link rel="prefetch" href="/assets/js/57.3801320b.js"><link rel="prefetch" href="/assets/js/58.c9e4b28b.js"><link rel="prefetch" href="/assets/js/59.073c9a09.js"><link rel="prefetch" href="/assets/js/6.0fa2c4ad.js"><link rel="prefetch" href="/assets/js/60.3b0710f8.js"><link rel="prefetch" href="/assets/js/61.ab3522ed.js"><link rel="prefetch" href="/assets/js/62.bcbae7e0.js"><link rel="prefetch" href="/assets/js/63.08553e1b.js"><link rel="prefetch" href="/assets/js/64.7b1d1b05.js"><link rel="prefetch" href="/assets/js/65.8ed9d62a.js"><link rel="prefetch" href="/assets/js/66.8edb25f6.js"><link rel="prefetch" href="/assets/js/67.4727fc6f.js"><link rel="prefetch" href="/assets/js/68.0fda644b.js"><link rel="prefetch" href="/assets/js/69.5e10210d.js"><link rel="prefetch" href="/assets/js/7.67571813.js"><link rel="prefetch" href="/assets/js/70.0fba869c.js"><link rel="prefetch" href="/assets/js/71.1b81b5c1.js"><link rel="prefetch" href="/assets/js/72.a3708c9f.js"><link rel="prefetch" href="/assets/js/73.8084709c.js"><link rel="prefetch" href="/assets/js/74.c6b92480.js"><link rel="prefetch" href="/assets/js/75.0aa461a8.js"><link rel="prefetch" href="/assets/js/76.1f78f475.js"><link rel="prefetch" href="/assets/js/77.3bc99dd4.js"><link rel="prefetch" href="/assets/js/78.bf3ce707.js"><link rel="prefetch" href="/assets/js/79.a21f49ee.js"><link rel="prefetch" href="/assets/js/80.ad501796.js"><link rel="prefetch" href="/assets/js/81.2871854f.js"><link rel="prefetch" href="/assets/js/82.e806cc3a.js"><link rel="prefetch" href="/assets/js/83.9927006c.js"><link rel="prefetch" href="/assets/js/84.48c0835e.js"><link rel="prefetch" href="/assets/js/85.4a4874d2.js"><link rel="prefetch" href="/assets/js/86.f79bd6bb.js"><link rel="prefetch" href="/assets/js/87.08bd836f.js"><link rel="prefetch" href="/assets/js/88.61e71e39.js"><link rel="prefetch" href="/assets/js/89.aff17c9d.js"><link rel="prefetch" href="/assets/js/9.a1c180e9.js"><link rel="prefetch" href="/assets/js/90.ea0ad8a7.js"><link rel="prefetch" href="/assets/js/91.300f83b1.js"><link rel="prefetch" href="/assets/js/92.3c9dac39.js"><link rel="prefetch" href="/assets/js/93.7beffc25.js"><link rel="prefetch" href="/assets/js/94.c5443ccd.js"><link rel="prefetch" href="/assets/js/95.92f453b5.js"><link rel="prefetch" href="/assets/js/96.1246dba7.js"><link rel="prefetch" href="/assets/js/97.56da5ba9.js"><link rel="prefetch" href="/assets/js/98.5f2bd081.js"><link rel="prefetch" href="/assets/js/99.26ef7258.js">
    <link rel="stylesheet" href="/assets/css/styles.4458c4ff.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      HPE Enterprise Containers
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link">Blog</a></div><a href="https://github.com/HewlettPackard/Docker-Synergy" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/" class="nav-link">Blog</a></div><a href="https://github.com/HewlettPackard/Docker-Synergy" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Introduction</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Release notes</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution overview</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution components</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Preparing the environment</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Configuring the core components</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Overview of the playbooks</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying core components</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Post deployment</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Configuring Storage</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Windows VM workers</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Deploying bare metal workers</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/deploy-bm/bm-intro.html" class="sidebar-link">Introduction to bare metal workers</a></li><li><a href="/deploy-bm/playbooks-configuration.html" class="sidebar-link">Playbooks and configuration</a></li><li><a href="/deploy-bm/osdp-custom-attributes.html" class="sidebar-link">OS Deployment Plan Custom Attributes</a></li><li><a href="/deploy-bm/rhel-golden-images.html" class="sidebar-link">RHEL Golden Images</a></li><li><a href="/deploy-bm/windows-golden-images.html" class="active sidebar-link">Windows Golden Images</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/deploy-bm/windows-golden-images.html#prepare-image-streamer-with-windows-artifact-bundle" class="sidebar-link">Prepare Image Streamer with Windows Artifact Bundle</a></li><li class="sidebar-sub-header"><a href="/deploy-bm/windows-golden-images.html#create-windows-golden-image" class="sidebar-link">Create Windows Golden Image</a></li><li class="sidebar-sub-header"><a href="/deploy-bm/windows-golden-images.html#capture-the-golden-image" class="sidebar-link">Capture the Golden Image</a></li><li class="sidebar-sub-header"><a href="/deploy-bm/windows-golden-images.html#golden-image-compatibility" class="sidebar-link">Golden Image Compatibility</a></li></ul></li><li><a href="/deploy-bm/deployment-plans.html" class="sidebar-link">OS Deployment Plans</a></li><li><a href="/deploy-bm/server-profile-templates.html" class="sidebar-link">OneView Server Profile Templates</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Sysdig monitoring</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Splunk</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Prometheus and Grafana on Kubernetes</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Deploying Prometheus and Grafana on Docker Swarm</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Backup and restore</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Solution lifecycle management</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Appendices</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="windows-golden-images"><a href="#windows-golden-images" aria-hidden="true" class="header-anchor">#</a> Windows Golden Images</h1><h2 id="prepare-image-streamer-with-windows-artifact-bundle"><a href="#prepare-image-streamer-with-windows-artifact-bundle" aria-hidden="true" class="header-anchor">#</a> Prepare Image Streamer with Windows Artifact Bundle</h2><ul><li>Download the &quot;HPE - Windows - 2018-10-26.zip&quot; artifact bundle from the GitHub repository at <a href="https://github.com/HewlettPackard/image-streamer-windows" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/image-streamer-windows</a>. The file is available in the <code>artifact-bundles</code> directory.  The artifacts are supported on HPE Image Streamer 4.1 and higher for Windows 2016,
while version 4.2 and higher are required for Windows 2019. This solution has been tested using Windows 2016 on HPE Image Streamer 4.1.</li><li>Upload the Artifact bundle to the Image Streamer appliance</li><li>Extract the Artifact Bundle on the Image Streamer appliance</li></ul><h2 id="create-windows-golden-image"><a href="#create-windows-golden-image" aria-hidden="true" class="header-anchor">#</a> Create Windows Golden Image</h2><p>The procedure for creating a Windows Server 2016 golden image are documented in the Image Streamer GitHub repostiory at <a href="https://github.com/HewlettPackard/image-streamer-windows" target="_blank" rel="noopener noreferrer">https://github.com/HewlettPackard/image-streamer-windows</a>. See the appropriate file in the <code>docs</code> directory <a href="https://github.com/HewlettPackard/image-streamer-windows/blob/v4.1/docs/HPE%20Synergy%20Image%20Streamer%20Microsoft%20Windows%20Artifact%20Bundle%20Documentation.pdf" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The instructions are repeated here for convenience, but you should rely on the Image Streamer repository for the definitive version of the documentation.</p><ol><li>Ensure that you have access to Windows 2016 or 2019 ISO file.</li><li>Create a server profile with <code>“HPE - Foundation 1.0 - create empty OS Volume”</code> as OS Deployment plan
and a server hardware of desired hardware type (see section on Golden Image Compatibility below). Set
an appropriate value for volume size in MiB units, say <code>40000 MiB</code>. The HPE Synergy Server will be
configured for access to this empty OS Volume.</li><li>Launch iLO Integrated Remote Console of this server and set the Windows 2016 or 2019 ISO file as
virtual CD-ROM/DVD image file. Power on the server.</li><li>Windows should present an option of installing from CD/DVD. Continue with this option.</li><li>Install Windows 2016 or 2019.</li><li>(Optional) To take a backup of this installation at this stage:<br>
a. Shutdown the server<br>
b. Perform an as-is capture using &quot;HPE - Windows - Capture - As-Is&quot; build plan to create the &quot;as-is&quot;
golden image of the OS.<br>
c. Deploy another server with the golden image captured in previous step and boot the server.</li><li>Install any additional software or roles if required.</li></ol><p>NOTE: The next six steps can be automated using the “PrepareForImageStreamerOSVolumeCapture.ps1” script in “scripts” directory on the GitHub repository where Windows artifact bundles are available for download.</p><ol start="8"><li><p>Create a FAT32 partition which will be used by the artifacts for personalization:
FAT 32 partition can be created either from UI using Disk Management utility (8.1) or using CMD Diskpart commands (8.2).</p><p>8.1 FAT32 partition creation from UI</p><pre><code> a. Open &quot;Computer Management&quot; &gt; &quot;Disk Management&quot;
 b. Select C: partition
 c. Shrink volume
 d. Change amount of space to shrink to 100 MB
 e. Select Shrink
 f. Select new Unallocated space
 g. Select New Simple Volume
 h. Leave size
 i. Assign drive letter, (Choose S)
 j. Format as FAT32 file system type (this requires changing from the default)
 k. Give Volume label as &quot;ISDEPLOY&quot;
 l. Finish
 m. “ISDEPLOY (S:)” should be shown
</code></pre><p>8.2 FAT32 partition creation using CMD commands<br>
Use list volume command to get volume number for C: partition. Here C: partition resides in Volume 0.</p><pre class="language-text"><code>C:\Users\Administrator&gt;diskpart 
DISKPART&gt;list volume 
DISKPART &gt;select volume 0 
DISKPART &gt;shrink desired=100 
DISKPART &gt;create partition primary size=100 
DISKPART &gt;format fs=fat32 quick label=ISDEPLOY 
DISKPART &gt;assign letter=S
</code></pre></li><li><p>Backup drive-letters</p><pre class="language-text"><code>reg export HKLM\System\MountedDevices C:\driveletters.reg
</code></pre></li><li><p>Generalize Windows using sysprep</p><p>WARNING: This operation is destructive and will remove all configuration. To take backup of the system at this stage, capture an as-is golden image.</p><p>Open Command Prompt window and run the following</p><pre class="language-text"><code>cd Windows\System32\Sysprep 
Sysprep /generalize /oobe /quit
</code></pre><p>This will take a few minutes to complete and will generalize the system. All settings will be lost. This does not remove any additional user accounts that are created. Any user accounts not required in the captured golden image must be manually deleted.</p></li><li><p>Restore drive-letters</p></li></ol><pre class="language-text"><code>reg import C:\driveletters.reg
</code></pre><ol start="12"><li>Set Unattend.xml location to the FAT32 partition</li></ol><pre class="language-text"><code>reg add HKLM\System\Setup /v UnattendFile /t REG_SZ /d &quot;S:\ISdeploy\Unattend.xml&quot;
</code></pre><ol start="13"><li>Set SetupComplete.cmd location to the FAT32 partition</li></ol><pre class="language-text"><code>mkdir C:\Windows\Setup\Scripts 
echo S:\ISdeploy\SetupComplete.cmd &gt; C:\Windows\Setup\Scripts\SetupComplete.cmd
</code></pre><ol start="14"><li><p>Shutdown the server.</p></li><li><p>Capture a golden image using the &quot;HPE - Windows - Capture - As-Is&quot; build plan as described in the following section.</p></li></ol><h2 id="capture-the-golden-image"><a href="#capture-the-golden-image" aria-hidden="true" class="header-anchor">#</a> Capture the Golden Image</h2><ul><li><p>Determine the OS Volume that was created for the Server Profile created earlier
<img src="/assets/img/bm-win-server-profile.8c815af6.png" alt=" "Server profile""></p><p><strong>Figure.</strong> Server profile</p></li><li><p>Navigate to the Image Streamer Golden Images page</p></li><li><p>Select &quot;Create golden image&quot; specifying the OS Volume and the &quot;HPE - Windows - Capture - As-Is&quot; build plan:
<img src="/assets/img/bm-win-create-golden-image.988951f7.png" alt=" "Create Golden Image""></p><p><strong>Figure.</strong> Create Golden Image</p></li><li><p>Select &quot;Create&quot;</p></li><li><p>Delete the Server Profile &quot;Windows Template&quot; used to create the golden image</p></li></ul><h2 id="golden-image-compatibility"><a href="#golden-image-compatibility" aria-hidden="true" class="header-anchor">#</a> Golden Image Compatibility</h2><p>The golden image created using the above method will work only when the image is deployed on server hardware of
the same model. Specifically, if the number of processors on server where the image is deployed is different from the
server where the image was captured, server boot after deployment will fail. Also, if the boot controller is moved from
one Mezzanine slot on the server to another, Windows will not boot correctly.</p></div><div class="content edit-link"><a href="https://github.com/HewlettPackard/Docker-Synergy/edit/devel/docs-src/deploy-bm/windows-golden-images.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/deploy-bm/rhel-golden-images.html" class="prev">
          RHEL Golden Images
        </a></span><span class="next"><a href="/deploy-bm/deployment-plans.html">
          OS Deployment Plans
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/app.4458c4ff.js" defer></script><script src="/assets/js/8.5e9abf7f.js" defer></script>
  </body>
</html>
